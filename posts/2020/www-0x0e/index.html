<!doctype html><html lang=en dir=auto>
<head><meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<meta name=robots content="index, follow">
<title>WWW 0x0E: è¦ªæ„›çš„ï¼Œæˆ‘æŠŠå¿«å–éƒ½æ”¾ä½ è…¦ä¸­äº† | Weihang Lo</title>
<meta name=keywords content="Cache,Databases">
<meta name=description content="If you cloud end Covid-19 by sacrificing a JavaScript framework, which one would you choose and why Angular? â€” @dabit3 2020.4.19 é€™è£¡æ˜¯ WWW ç¬¬æ‹¾è‚†æœŸï¼ŒWow Weihang Weekly æ˜¯ä¸€å€‹æ¯«ç„¡ç« æ³•çš„å€‹äººé€±åˆŠï¼Œå‡ºåˆŠé€±æœŸæ¥µä¸å›ºå®šï¼Œå¾ä¸€é€±åˆ°äº”å¹´éƒ½æœ‰å¯èƒ½ã€‚åˆæœŸ">
<meta name=author content>
<link rel=canonical href=https://weihanglo.tw/posts/2020/www-0x0e/>
<link crossorigin=anonymous href=/assets/css/stylesheet.min.css rel="preload stylesheet" as=style>
<script defer crossorigin=anonymous src=/assets/js/highlight.min.js onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://weihanglo.tw/favicon.ico>
<link rel=icon type=image/png sizes=16x16 href=https://weihanglo.tw/favicon-16x16.png>
<link rel=icon type=image/png sizes=32x32 href=https://weihanglo.tw/favicon-32x32.png>
<link rel=apple-touch-icon href=https://weihanglo.tw/apple-touch-icon.png>
<link rel=mask-icon href=https://weihanglo.tw/safari-pinned-tab.svg>
<meta name=theme-color content="#2e2e33">
<meta name=msapplication-TileColor content="#2e2e33">
<noscript>
<style>#theme-toggle,.top-link{display:none}</style>
<style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style>
</noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css integrity=sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ crossorigin=anonymous>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.js integrity=sha384-VQ8d8WVFw0yHhCk5E8I86oOhv48xLpnDZx5T9GogA/Y84DcCKWXDmSDfn13bzFZY crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/contrib/auto-render.min.js integrity=sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR crossorigin=anonymous></script>
<script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:'$$',right:'$$',display:!0},{left:'$',right:'$',display:!1},{left:'\\(',right:'\\)',display:!1},{left:'\\[',right:'\\]',display:!0}],throwOnError:!1})})</script>
<meta property="og:title" content="WWW 0x0E: è¦ªæ„›çš„ï¼Œæˆ‘æŠŠå¿«å–éƒ½æ”¾ä½ è…¦ä¸­äº†">
<meta property="og:description" content="If you cloud end Covid-19 by sacrificing a JavaScript framework, which one would you choose and why Angular? â€” @dabit3 2020.4.19 é€™è£¡æ˜¯ WWW ç¬¬æ‹¾è‚†æœŸï¼ŒWow Weihang Weekly æ˜¯ä¸€å€‹æ¯«ç„¡ç« æ³•çš„å€‹äººé€±åˆŠï¼Œå‡ºåˆŠé€±æœŸæ¥µä¸å›ºå®šï¼Œå¾ä¸€é€±åˆ°äº”å¹´éƒ½æœ‰å¯èƒ½ã€‚åˆæœŸ">
<meta property="og:type" content="article">
<meta property="og:url" content="https://weihanglo.tw/posts/2020/www-0x0e/"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2020-04-25T00:00:00+08:00">
<meta property="article:modified_time" content="2020-04-25T00:00:00+08:00">
<meta name=twitter:card content="summary">
<meta name=twitter:title content="WWW 0x0E: è¦ªæ„›çš„ï¼Œæˆ‘æŠŠå¿«å–éƒ½æ”¾ä½ è…¦ä¸­äº†">
<meta name=twitter:description content="If you cloud end Covid-19 by sacrificing a JavaScript framework, which one would you choose and why Angular? â€” @dabit3 2020.4.19 é€™è£¡æ˜¯ WWW ç¬¬æ‹¾è‚†æœŸï¼ŒWow Weihang Weekly æ˜¯ä¸€å€‹æ¯«ç„¡ç« æ³•çš„å€‹äººé€±åˆŠï¼Œå‡ºåˆŠé€±æœŸæ¥µä¸å›ºå®šï¼Œå¾ä¸€é€±åˆ°äº”å¹´éƒ½æœ‰å¯èƒ½ã€‚åˆæœŸ">
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://weihanglo.tw/posts/"},{"@type":"ListItem","position":3,"name":"WWW 0x0E: è¦ªæ„›çš„ï¼Œæˆ‘æŠŠå¿«å–éƒ½æ”¾ä½ è…¦ä¸­äº†","item":"https://weihanglo.tw/posts/2020/www-0x0e/"}]}</script>
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"WWW 0x0E: è¦ªæ„›çš„ï¼Œæˆ‘æŠŠå¿«å–éƒ½æ”¾ä½ è…¦ä¸­äº†","name":"WWW 0x0E: è¦ªæ„›çš„ï¼Œæˆ‘æŠŠå¿«å–éƒ½æ”¾ä½ è…¦ä¸­äº†","description":"If you cloud end Covid-19 by sacrificing a JavaScript framework, which one would you choose and why Angular? â€” @dabit3 2020.4.19 é€™è£¡æ˜¯ WWW ç¬¬æ‹¾è‚†æœŸï¼ŒWow Weihang Weekly æ˜¯ä¸€å€‹æ¯«ç„¡ç« æ³•çš„å€‹äººé€±åˆŠï¼Œå‡ºåˆŠé€±æœŸæ¥µä¸å›ºå®šï¼Œå¾ä¸€é€±åˆ°äº”å¹´éƒ½æœ‰å¯èƒ½ã€‚åˆæœŸ","keywords":["Cache","Databases"],"articleBody":" If you cloud end Covid-19 by sacrificing a JavaScript framework, which one would you choose and why Angular?\nâ€” @dabit3 2020.4.19\n é€™è£¡æ˜¯ WWW ç¬¬æ‹¾è‚†æœŸï¼ŒWow Weihang Weekly æ˜¯ä¸€å€‹æ¯«ç„¡ç« æ³•çš„å€‹äººé€±åˆŠï¼Œå‡ºåˆŠé€±æœŸæ¥µä¸å›ºå®šï¼Œå¾ä¸€é€±åˆ°äº”å¹´éƒ½æœ‰å¯èƒ½ã€‚åˆæœŸå…§å®¹ä»¥è»Ÿé«”å·¥ç¨‹ç‚ºä¸»ï¼Œç­‰è²¡å¯Œè‡ªç”±å¾Œæœƒæœ‰æ›´å¤šé›œé£Ÿç¯‡ç« ã€‚\nApple just killed Offline Web Apps while purporting to protect your privacy: why thatâ€™s A Bad Thing and why you should care æ¨™é¡Œå¾ˆè³å‹•ä½†ç„¡èª¤ï¼ŒApple æ±ºå®šå¹« Safari çµ¦æ‰€æœ‰ storage åŠ ä¸Šä¸€å€‹**ã€Œä¸ƒå¤©æ²’é€²ç«™å°±åˆªæ‰ã€**çš„é™åˆ¶ï¼Œä¸è² è²¬ä»»çŒœæ¸¬æ˜¯ app ç‡Ÿæ”¶ä¸å¥½ã€‚\nCopyrighting all the melodies to avoid accidental infringement  All the Music LLC æ˜¯ä¸€é–“æ‡·æŠ±å¤¢æƒ³çš„å…¬å¸ï¼Œä»–å€‘å°‡æ—‹å¾‹è¦–ç‚ºæœ‰é™çš„æ•¸å­¸æ’åˆ—çµ„åˆï¼Œè€Œæ•¸å­¸æ˜¯æ—¢æœ‰äº‹å¯¦ï¼Œæ‰€ä»¥æ²’æœ‰è‘—ä½œæ¬Šï¼Œç„¶å¾Œå†åˆ©ç”¨ç¨‹å¼çµ„åˆä¸åŒéŸ³é«˜çš„éŸ³ç¬¦ï¼Œæ¯ç§’ç”¢ç”Ÿä¸‰åè¬ä¸åŒæ—‹å¾‹çš„ midiï¼Œæ”¾åœ¨ public domainï¼Œé€²è€Œä¿éšœéŸ³æ¨‚å‰µä½œè€…ä¸æœƒè¢«ä¾†è·¯ä¸æ˜çš„è‘—ä½œæ¬ŠèŸ‘è‚å¿åˆ°æ­»ã€‚\nè©²å°ˆæ¡ˆèªç‚ºï¼ŒéŸ³æ¨‚æ˜¯ç”±æ—‹å¾‹ã€ç¯€å¥ã€åˆè²ï¼ŒéŸ³è‰²çš„è¦ç´ çµ„åˆï¼Œä½†åœ¨ç¯€å¥å·®è·ä¸å¤§çš„æƒ…æ³ä¸‹ï¼Œè½èµ·ä¾†æœƒåƒåŒä¸€å€‹æ—‹å¾‹ï¼ŒåŠ ä¸Šç¾åœ‹è‘—ä½œæ¬Šæœ‰ã€Œå¯¦è³ªç›¸ä¼¼æ€§ã€çš„æ¦‚å¿µï¼Œæ‰€ä»¥ç›®å‰çª®èˆ‰ 8 å€‹éŸ³é«˜ x 12 å€‹éŸ³ç¬¦çµ„åˆçš„æ—‹å¾‹å³å¯æ¶µè“‹å¤§éƒ¨åˆ†çš„æ—‹å¾‹ï¼ˆä¹‹å¾ŒåˆåŠ ä¸Šæ›´å¤šå°èª¿ï¼Œä»¥æ¶µè“‹æ›´å¤šç¨®é¡çš„éŸ³æ¨‚ï¼‰ã€‚\né€™å€‹å°ˆæ¡ˆæˆ‘è¦ºå¾—éå¸¸æœ‰è¶£ï¼Œè€Œä¸”æ˜¯ç”¨ Rust å¯«çš„ï¼ä¸éå…¶å¯¦ä¸–ç•Œä¸ŠéŸ³æ¨‚ä¸æ˜¯åªæœ‰è¥¿æ–¹å¤å…¸éŸ³æ¨‚çš„äº”ç·šè­œï¼Œå°åº¦ã€ä¸­åœ‹ã€æ—¥æœ¬é‚„æœ‰å¤§å¤§å°å°çš„éƒ¨è½æ°‘æ—éƒ½æœ‰å„ç¨®è¶…è¶Šäº”ç·šè­œçš„éŸ³æ¨‚ï¼Œé€™äº›è‘—ä½œæ¬Šè¦æ€éº¼ä¿éšœï¼Ÿåˆè¦æ€æ¨£è®“å‰µä½œè€…ç›¡æƒ…ç™¼æ®ï¼Ÿä»ç„¶æœ‰é›£åº¦å­˜åœ¨ã€‚\n æ›´å¤šç´°ç¯€å¯ä»¥çœ‹å°ˆæ¡ˆçš„ FAQï¼Œé›–ç„¶è¼‰å…¥è¶…æ…¢â€¦\n Why We Started Putting Unpopular Assets in Memory  Image from Cloudflare blog\n ä¹è½ä¹‹ä¸‹ï¼Œæ¨™é¡Œè³å‹•é§­äººï¼Œä¾ç„¶æ¨è–¦é–±è®€æ­¤æ–‡ã€‚æŠ½çµ²å‰ç¹­ï¼Œå±¤å±¤ç†å‡ºæŠ€è¡“æ±ºç­–å¦‚ä½•å¾è§€å¯Ÿã€å¯¦é©—ã€å¯èƒ½å•é¡Œã€ç¾å¯¦éƒ¨ç½²æƒ…æ³ï¼Œåˆ°æœªä¾†å±•æœ›çš„è„ˆçµ¡ï¼Œå€¼å¾—æŠ€è¡“æ’°æ–‡è€…åƒè€ƒã€‚ç¨åŠ æ‘˜è¦ï¼ˆæ ¹æœ¬ç¨±ä¸ä¸Šæ˜¯æ‘˜è¦ï¼‰ï¼š\nèƒŒæ™¯ Cloudflare çš„ Cache æ”¾åœ¨ SSDï¼Œå®¢è£½åŒ–çš„è¶…å¼· SSDï¼Œä½†ä»é­é‡ä¸€äº›å•é¡Œï¼š\n å•é¡Œä¸€ï¼š SSD çš„ IO æ˜¯é€ æˆ tail latency çš„ä¸»å›  å•é¡ŒäºŒï¼š ç‰©ç† SSD å£æ‰æ›¿æ›çš„ç¶­é‹æˆæœ¬å¾ˆé«˜ï¼ˆCloudflare åœ¨å…©ç™¾åº§åŸå¸‚çš„è³‡æ–™ä¸­å¿ƒçš„é‹è²»ã€äººåŠ›æ›¿æ›æˆæœ¬ï¼‰  è§€å¯Ÿç¾æ³ ç†±é»è³‡æºå·²æœ‰ä½œæ¥­ç³»çµ± page cache å°‡ä¹‹æ”¾åœ¨ memoryï¼š\n Linux LRU ç­‰å„ç¨®æ¼”ç®—æ³•æ—©å°±é‡å°ç†±é»åšè®€å–å¿«å– page cache ä¹Ÿæœƒåšå¯«å…¥ç·©è¡ï¼ˆbuffer writeï¼‰ ä½† Cloudflare ä½œç‚º CDN æœå‹™ï¼Œæ›´æ–°è³‡æºæ¬¡æ•¸æ¥µå°‘ï¼Œpage cache æ²’è¾¦æ³•å¹«åŠ©æ¸›å°‘ç¡¬ç¢Ÿå¯«å…¥  éç†±é»è³‡æºä¼¼ä¹å¯ä»¥æ”¾é€² memoryï¼š\n å‹•æ©Ÿä¸€ï¼š å¯«å…¥éå¤šå°è‡´ SSD å£½å‘½é©Ÿæ¸›ï¼Œå¯«å…¥éœ€è¦å° storage æ™¶ç‰‡é€ P/E operation ï¼Œé€™å€‹ operation æœƒé˜»æ“‹ read ops å‹•æ©ŸäºŒï¼š å¾ˆå¤šè³‡æºéƒ½æ˜¯ä¸€æ¬¡æ€§å†ä¹Ÿä¸æœƒå­˜å–ç¬¬äºŒæ¬¡  å‡èªªï¼š æ¸›å°‘ç¡¬ç¢Ÿå¯«å…¥å¯åŠ é€Ÿç¡¬ç¢Ÿè®€å– æ–¹æ³•ï¼š åª cache ç¬¬äºŒæ¬¡å­˜å–çš„è³‡æº çµæœï¼š æ¸›å°‘ç¡¬ç¢Ÿå¯«å…¥æ¬¡æ•¸ï¼ŒP75 cache hit duration ä¹Ÿé™ä½ï¼Œå› ç‚ºä¸éœ€è¦ evict éç†±é»è³‡æºã€cache hit ratio å’Œ retention ä¹Ÿæé«˜äº†    å¦‚ä½•å¯¦ä½œ è§£æ³•ä¸€ï¼š ç´€éŒ„å­˜å–æ¬¡æ•¸ï¼Œä½†ä¸è¦å¿«å–\n ç”¨ bloom filter ç­‰ memory-efficient è³‡æ–™çµæ§‹ä¾†å„²å­˜å­˜å–æ¬¡æ•¸ æ–°å•é¡Œï¼šè³‡æºéƒ½æœƒ miss ç¬¬äºŒæ¬¡æ‰æœƒè¢« cacheï¼Œé€™å° CDN ä¾›æ‡‰å•†æˆ–å®¢æˆ¶ä¾†èªªéƒ½ç„¡æ³•æ¥å—ã€‚  è§£æ³•äºŒï¼š å¤šä¸€å€‹ transient cache (in memory cache)ã€‚\n å…ˆå°‡æ¬²å¿«å–åˆ° SSD çš„è³‡æºæ”¾åœ¨ memory ä¸­ï¼Œå¦‚æœå­˜å–å®ƒå¤ªå¤šæ¬¡ï¼Œå°± promote åˆ° SSD ä¸­ æ²’è¢« promote çš„è³‡æºæœ€å¾Œæœƒè¢« evict  æ¬Šè¡¡ é€™è½èµ·ä¾†å¾ˆåˆç†ï¼Œå…¨éƒ¨æ”¾åˆ° memory ä¸­ï¼Œä½†å…¶å¯¦éœ€è¦åœ¨ SSD å£½å‘½ã€cache tail hit latency å’Œ memory ä½¿ç”¨é‡ä¹‹é–“æ¬Šè¡¡ï¼Œè€Œé€™æ¬¡å½±éŸ¿æœ€å¤§çš„å°±æ˜¯ memory ä½¿ç”¨é‡ä¸Šå‡ï¼š\n transient cache memory ç©¶ç«Ÿè¦å¤šå¤§ï¼š å½±éŸ¿ evictionã€cache hit ratio å’Œ page cache ç«¶çˆ­ï¼š page cache æŠ“ç†±é–€è³‡æºã€ä½† transient cache å¤§å¤šç‚ºéç†±é–€ï¼Œæœ‰æ’æ“ æ•ˆæ‡‰ å’Œ process memory ç«¶çˆ­ï¼š process å’Œ page cache ä¸ä¸€æ¨£ï¼Œå° memory æœ‰å‰›æ€§éœ€æ±‚ï¼Œè€Œä¸” edge service çš„å‡ç´šéœ€è¦ zero downtimeï¼Œæ‰€ä»¥æœƒåŒæ™‚æœ‰å…©å€‹ç‰ˆæœ¬çš„æœå‹™ï¼ˆè—ç¶ ä½ˆç½² ğŸ™ƒï¼‰ï¼Œå¦‚æœè¨˜æ†¶é«”ä¸å¤ ï¼Œå°±æœƒè®“ page cache æ¸›å°‘ï¼Œåè€Œå¢åŠ  IOã€‚  æœ‰æ®µè©±é€éœ²å‡º Cloudflare å°æ–¼å®¢æˆ¶å¤ªåœ¨ä¹ miss rate çš„æŠ±æ€¨ï¼Œèªç‚ºåªæ˜¯åœ¨åšå–ã€Œçœ¼çƒæ•ˆèƒ½ã€ğŸ˜ˆ\n From a customerâ€™s perspective, cache retention being too short is unacceptable because it leads to more misses, commensurate higher cost, and worse eyeball performance.\n çµæœèˆ‡å±•æœ› Cloudlfare æ¡å–åœ¨æ–°çš„æ©Ÿå™¨ä¸Šéƒ¨ç½²æ–°çš„ transient cacheï¼Œä¸¦åªåœ¨éƒ¨åˆ† asset ä½¿ç”¨ï¼Œä¸æ–·å°‹æ‰¾ memory size çš„ç”œèœœé»ï¼Œæœ€å¾Œçµæœç‚º\n åœ¨ SSD å£½å‘½ã€cache tail hit latency å’Œ memory ä½¿ç”¨é‡ä¸‰è€…é–“ï¼ŒCloudflare é¸æ“‡å‰å…©è€… æ¸›å°‘ 20%-25% SSD å¯«å…¥ CDN tail latency åœ¨é«˜å³°æœŸé–“ä¹Ÿæ¸›å°‘äº† 20%  è€Œå°æœªä¾†å¯ä»¥åšæ›´å¥½çš„éƒ¨åˆ†å‰‡æ˜¯ï¼š\n éƒ¨ç½²æ›´å¤šï¼š èˆŠæ©Ÿå™¨é€€å½¹å¾Œï¼Œæ–°ä¸–ä»£æ©Ÿå™¨ï¼ˆæ›´å¤š memory çš„æ©Ÿå™¨ï¼‰å°±æœƒä¸Šå» æ›´æ™ºæ…§çš„ promotion æ¼”ç®—æ³•ï¼š ç¾åœ¨åƒ…é€éè³‡æºè§¸æ“Šæ•¸ï¼Œæœªä¾†å¯ä¾æ“šè³‡æºçš„ TTL æ±ºå®šæ˜¯å¦ promoteï¼›å¦ä¸€é¢å‘å‰‡æ˜¯ demotionï¼Œé›–ç„¶ä¸æœƒæ¸›å°‘ç¡¬ç¢Ÿå¯«å…¥ï¼Œä½†å¯å¢åŠ  cache hit ratio å’Œ cache retention ç”¨å…¶ä»–å„²å­˜è£ç½®åš transient cacheï¼š é¸æ“‡ memory æ˜¯å› ç‚ºæè€—èŠ±è²»ä½ï¼ŒHDD åŒæ¨£è€æ“ï¼Œå¯ä»¥è€ƒæ…®æ··åˆ SSDã€HDDã€memory åœ¨è²»ç”¨å’Œæ•ˆèƒ½å–å¾—å¹³è¡¡  ","wordCount":"1700","inLanguage":"en","datePublished":"2020-04-25T00:00:00+08:00","dateModified":"2020-04-25T00:00:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://weihanglo.tw/posts/2020/www-0x0e/"},"publisher":{"@type":"Organization","name":"Weihang Lo","logo":{"@type":"ImageObject","url":"https://weihanglo.tw/favicon.ico"}}}</script>
</head>
<body id=top>
<script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add('dark'):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove('dark'):window.matchMedia('(prefers-color-scheme: dark)').matches&&document.body.classList.add('dark')</script>
<header class=header>
<nav class=nav>
<div class=logo>
<a href=https://weihanglo.tw accesskey=h title="Weihang Lo (Alt + H)">Weihang Lo</a>
<span class=logo-switches>
<button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
</button>
</span>
</div>
<ul id=menu>
<li>
<a href=https://weihanglo.tw/ title=Home>
<span>Home</span>
</a>
</li>
<li>
<a href=https://weihanglo.tw/posts/ title=Posts>
<span>Posts</span>
</a>
</li>
<li>
<a href=https://weihanglo.tw/tags/ title=Tags>
<span>Tags</span>
</a>
</li>
<li>
<a href=https://weihanglo.tw/about/ title=About>
<span>About</span>
</a>
</li>
</ul>
</nav>
</header>
<main class=main>
<article class=post-single>
<header class=post-header>
<h1 class=post-title>
WWW 0x0E: è¦ªæ„›çš„ï¼Œæˆ‘æŠŠå¿«å–éƒ½æ”¾ä½ è…¦ä¸­äº†
</h1>
<div class=post-meta><span title="2020-04-25 00:00:00 +0800 +0800">April 25, 2020</span>&nbsp;Â·&nbsp;4 min
</div>
</header> <div class=toc>
<details>
<summary accesskey=c title="(Alt + C)">
<span class=details>Table of Contents</span>
</summary>
<div class=inner><ul>
<li>
<a href=#apple-just-killed-offline-web-apps-while-purporting-to-protect-your-privacy-why-thats-a-bad-thing-and-why-you-should-carehttpsaral20200325apple-just-killed-offline-web-apps-while-purporting-to-protect-your-privacy-why-thats-a-bad-thing-and-why-you-should-care aria-label="Apple just killed Offline Web Apps while purporting to protect your privacy: why thatâ€™s A Bad Thing and why you should care"><a href=https://ar.al/2020/03/25/apple-just-killed-offline-web-apps-while-purporting-to-protect-your-privacy-why-thats-a-bad-thing-and-why-you-should-care/>Apple just killed Offline Web Apps while purporting to protect your privacy: why thatâ€™s A Bad Thing and why you should care</a></a></li>
<li>
<a href=#copyrighting-all-the-melodies-to-avoid-accidental-infringement-httpsyoutubesjtm0moogiu aria-label="Copyrighting all the melodies to avoid accidental infringement "><a href=https://youtu.be/sJtm0MoOgiU>Copyrighting all the melodies to avoid accidental infringement </a></a></li>
<li>
<a href=#why-we-started-putting-unpopular-assets-in-memoryhttpsblogcloudflarecomwhy-we-started-putting-unpopular-assets-in-memory aria-label="Why We Started Putting Unpopular Assets in Memory"><a href=https://blog.cloudflare.com/why-we-started-putting-unpopular-assets-in-memory/>Why We Started Putting Unpopular Assets in Memory</a></a><ul>
<li>
<a href=#%e8%83%8c%e6%99%af aria-label=èƒŒæ™¯>èƒŒæ™¯</a></li>
<li>
<a href=#%e8%a7%80%e5%af%9f%e7%8f%be%e6%b3%81 aria-label=è§€å¯Ÿç¾æ³>è§€å¯Ÿç¾æ³</a></li>
<li>
<a href=#%e5%a6%82%e4%bd%95%e5%af%a6%e4%bd%9c aria-label=å¦‚ä½•å¯¦ä½œ>å¦‚ä½•å¯¦ä½œ</a></li></ul>
</li>
<li>
<a href=#%e6%ac%8a%e8%a1%a1 aria-label=æ¬Šè¡¡>æ¬Šè¡¡</a></li>
<li>
<a href=#%e7%b5%90%e6%9e%9c%e8%88%87%e5%b1%95%e6%9c%9b aria-label=çµæœèˆ‡å±•æœ›>çµæœèˆ‡å±•æœ›</a>
</li>
</ul>
</div>
</details>
</div>
<div class=post-content><blockquote>
<p>If you cloud end Covid-19 by sacrificing a JavaScript framework, which one would you choose and why Angular?</p>
<p>â€” <a href="https://twitter.com/dabit3/status/1251597948472999936?s=20">@dabit3</a> 2020.4.19</p>
</blockquote>
<p>é€™è£¡æ˜¯ WWW ç¬¬æ‹¾è‚†æœŸï¼ŒWow Weihang Weekly æ˜¯ä¸€å€‹æ¯«ç„¡ç« æ³•çš„å€‹äººé€±åˆŠï¼Œå‡ºåˆŠé€±æœŸæ¥µä¸å›ºå®šï¼Œå¾ä¸€é€±åˆ°äº”å¹´éƒ½æœ‰å¯èƒ½ã€‚åˆæœŸå…§å®¹ä»¥è»Ÿé«”å·¥ç¨‹ç‚ºä¸»ï¼Œç­‰è²¡å¯Œè‡ªç”±å¾Œæœƒæœ‰æ›´å¤šé›œé£Ÿç¯‡ç« ã€‚</p>
<h2 id=apple-just-killed-offline-web-apps-while-purporting-to-protect-your-privacy-why-thats-a-bad-thing-and-why-you-should-carehttpsaral20200325apple-just-killed-offline-web-apps-while-purporting-to-protect-your-privacy-why-thats-a-bad-thing-and-why-you-should-care><a href=https://ar.al/2020/03/25/apple-just-killed-offline-web-apps-while-purporting-to-protect-your-privacy-why-thats-a-bad-thing-and-why-you-should-care/>Apple just killed Offline Web Apps while purporting to protect your privacy: why thatâ€™s A Bad Thing and why you should care</a><a hidden class=anchor aria-hidden=true href=#apple-just-killed-offline-web-apps-while-purporting-to-protect-your-privacy-why-thats-a-bad-thing-and-why-you-should-carehttpsaral20200325apple-just-killed-offline-web-apps-while-purporting-to-protect-your-privacy-why-thats-a-bad-thing-and-why-you-should-care>#</a></h2>
<p>æ¨™é¡Œå¾ˆè³å‹•ä½†ç„¡èª¤ï¼ŒApple æ±ºå®šå¹« Safari çµ¦æ‰€æœ‰ storage åŠ ä¸Šä¸€å€‹**ã€Œä¸ƒå¤©æ²’é€²ç«™å°±åˆªæ‰ã€**çš„é™åˆ¶ï¼Œä¸è² è²¬ä»»çŒœæ¸¬æ˜¯ app ç‡Ÿæ”¶ä¸å¥½ã€‚</p>
<h2 id=copyrighting-all-the-melodies-to-avoid-accidental-infringement-httpsyoutubesjtm0moogiu><a href=https://youtu.be/sJtm0MoOgiU>Copyrighting all the melodies to avoid accidental infringement </a><a hidden class=anchor aria-hidden=true href=#copyrighting-all-the-melodies-to-avoid-accidental-infringement-httpsyoutubesjtm0moogiu>#</a></h2>
<p><a href=http://allthemusic.info>All the Music LLC</a> æ˜¯ä¸€é–“æ‡·æŠ±å¤¢æƒ³çš„å…¬å¸ï¼Œä»–å€‘å°‡æ—‹å¾‹è¦–ç‚ºæœ‰é™çš„æ•¸å­¸æ’åˆ—çµ„åˆï¼Œè€Œæ•¸å­¸æ˜¯æ—¢æœ‰äº‹å¯¦ï¼Œæ‰€ä»¥æ²’æœ‰è‘—ä½œæ¬Šï¼Œç„¶å¾Œå†åˆ©ç”¨ç¨‹å¼çµ„åˆä¸åŒéŸ³é«˜çš„éŸ³ç¬¦ï¼Œæ¯ç§’ç”¢ç”Ÿä¸‰åè¬ä¸åŒæ—‹å¾‹çš„ midiï¼Œæ”¾åœ¨ public domainï¼Œé€²è€Œä¿éšœéŸ³æ¨‚å‰µä½œè€…ä¸æœƒè¢«ä¾†è·¯ä¸æ˜çš„è‘—ä½œæ¬ŠèŸ‘è‚å¿åˆ°æ­»ã€‚</p>
<p>è©²å°ˆæ¡ˆèªç‚ºï¼ŒéŸ³æ¨‚æ˜¯ç”±æ—‹å¾‹ã€ç¯€å¥ã€åˆè²ï¼ŒéŸ³è‰²çš„è¦ç´ çµ„åˆï¼Œä½†åœ¨ç¯€å¥å·®è·ä¸å¤§çš„æƒ…æ³ä¸‹ï¼Œè½èµ·ä¾†æœƒåƒåŒä¸€å€‹æ—‹å¾‹ï¼ŒåŠ ä¸Šç¾åœ‹è‘—ä½œæ¬Šæœ‰ã€Œ<a href=https://en.wikipedia.org/wiki/Substantial_similarity#Substantial_similarity_in_copyright_infringement>å¯¦è³ªç›¸ä¼¼æ€§</a>ã€çš„æ¦‚å¿µï¼Œæ‰€ä»¥ç›®å‰çª®èˆ‰ 8 å€‹éŸ³é«˜ x 12 å€‹éŸ³ç¬¦çµ„åˆçš„æ—‹å¾‹å³å¯æ¶µè“‹å¤§éƒ¨åˆ†çš„æ—‹å¾‹ï¼ˆä¹‹å¾ŒåˆåŠ ä¸Šæ›´å¤šå°èª¿ï¼Œä»¥æ¶µè“‹æ›´å¤šç¨®é¡çš„éŸ³æ¨‚ï¼‰ã€‚</p>
<p>é€™å€‹å°ˆæ¡ˆæˆ‘è¦ºå¾—éå¸¸æœ‰è¶£ï¼Œè€Œä¸”æ˜¯<a href=https://github.com/allthemusicllc>ç”¨ Rust å¯«çš„</a>ï¼ä¸éå…¶å¯¦ä¸–ç•Œä¸ŠéŸ³æ¨‚ä¸æ˜¯åªæœ‰è¥¿æ–¹å¤å…¸éŸ³æ¨‚çš„äº”ç·šè­œï¼Œå°åº¦ã€ä¸­åœ‹ã€æ—¥æœ¬é‚„æœ‰å¤§å¤§å°å°çš„éƒ¨è½æ°‘æ—éƒ½æœ‰å„ç¨®è¶…è¶Šäº”ç·šè­œçš„éŸ³æ¨‚ï¼Œé€™äº›è‘—ä½œæ¬Šè¦æ€éº¼ä¿éšœï¼Ÿåˆè¦æ€æ¨£è®“å‰µä½œè€…ç›¡æƒ…ç™¼æ®ï¼Ÿä»ç„¶æœ‰é›£åº¦å­˜åœ¨ã€‚</p>
<blockquote>
<p>æ›´å¤šç´°ç¯€å¯ä»¥çœ‹å°ˆæ¡ˆçš„ <a href=http://allthemusic.info/faqs/>FAQ</a>ï¼Œé›–ç„¶è¼‰å…¥è¶…æ…¢&mldr;</p>
</blockquote>
<h2 id=why-we-started-putting-unpopular-assets-in-memoryhttpsblogcloudflarecomwhy-we-started-putting-unpopular-assets-in-memory><a href=https://blog.cloudflare.com/why-we-started-putting-unpopular-assets-in-memory/>Why We Started Putting Unpopular Assets in Memory</a><a hidden class=anchor aria-hidden=true href=#why-we-started-putting-unpopular-assets-in-memoryhttpsblogcloudflarecomwhy-we-started-putting-unpopular-assets-in-memory>#</a></h2>
<p><img loading=lazy src=https://blog-cloudflare-com-assets.storage.googleapis.com/2020/03/pasted-image-0--4--1.png alt>
</p>
<blockquote>
<p>Image from Cloudflare blog</p>
</blockquote>
<p>ä¹è½ä¹‹ä¸‹ï¼Œæ¨™é¡Œè³å‹•é§­äººï¼Œä¾ç„¶æ¨è–¦é–±è®€æ­¤æ–‡ã€‚æŠ½çµ²å‰ç¹­ï¼Œå±¤å±¤ç†å‡ºæŠ€è¡“æ±ºç­–å¦‚ä½•å¾è§€å¯Ÿã€å¯¦é©—ã€å¯èƒ½å•é¡Œã€ç¾å¯¦éƒ¨ç½²æƒ…æ³ï¼Œåˆ°æœªä¾†å±•æœ›çš„è„ˆçµ¡ï¼Œå€¼å¾—æŠ€è¡“æ’°æ–‡è€…åƒè€ƒã€‚ç¨åŠ æ‘˜è¦ï¼ˆæ ¹æœ¬ç¨±ä¸ä¸Šæ˜¯æ‘˜è¦ï¼‰ï¼š</p>
<h3 id=èƒŒæ™¯>èƒŒæ™¯<a hidden class=anchor aria-hidden=true href=#èƒŒæ™¯>#</a></h3>
<p>Cloudflare çš„ Cache æ”¾åœ¨ SSDï¼Œ<a href=https://blog.cloudflare.com/cloudflares-gen-x-servers-for-an-accelerated-future/>å®¢è£½åŒ–çš„è¶…å¼· SSD</a>ï¼Œä½†ä»é­é‡ä¸€äº›å•é¡Œï¼š</p>
<ul>
<li><strong>å•é¡Œä¸€ï¼š</strong> SSD çš„ IO æ˜¯é€ æˆ tail latency çš„ä¸»å› </li>
<li><strong>å•é¡ŒäºŒï¼š</strong> ç‰©ç† SSD å£æ‰æ›¿æ›çš„ç¶­é‹æˆæœ¬å¾ˆé«˜ï¼ˆCloudflare åœ¨å…©ç™¾åº§åŸå¸‚çš„è³‡æ–™ä¸­å¿ƒçš„é‹è²»ã€äººåŠ›æ›¿æ›æˆæœ¬ï¼‰</li>
</ul>
<h3 id=è§€å¯Ÿç¾æ³>è§€å¯Ÿç¾æ³<a hidden class=anchor aria-hidden=true href=#è§€å¯Ÿç¾æ³>#</a></h3>
<p>ç†±é»è³‡æºå·²æœ‰ä½œæ¥­ç³»çµ± page cache å°‡ä¹‹æ”¾åœ¨ memoryï¼š</p>
<ul>
<li>Linux LRU ç­‰å„ç¨®æ¼”ç®—æ³•æ—©å°±é‡å°ç†±é»åšè®€å–å¿«å–</li>
<li>page cache ä¹Ÿæœƒåšå¯«å…¥ç·©è¡ï¼ˆbuffer writeï¼‰ ä½† Cloudflare ä½œç‚º CDN æœå‹™ï¼Œæ›´æ–°è³‡æºæ¬¡æ•¸æ¥µå°‘ï¼Œpage cache æ²’è¾¦æ³•å¹«åŠ©æ¸›å°‘ç¡¬ç¢Ÿå¯«å…¥</li>
</ul>
<p>éç†±é»è³‡æºä¼¼ä¹å¯ä»¥æ”¾é€² memoryï¼š</p>
<ul>
<li><strong>å‹•æ©Ÿä¸€ï¼š</strong> å¯«å…¥éå¤š<a href=https://www.usenix.org/conference/fast12/reducing-ssd-read-latency-nand-flash-program-and-erase-suspension>å°è‡´ SSD å£½å‘½é©Ÿæ¸›</a>ï¼Œå¯«å…¥éœ€è¦å° storage æ™¶ç‰‡é€ P/E operation ï¼Œé€™å€‹ operation æœƒé˜»æ“‹ read ops</li>
<li><strong>å‹•æ©ŸäºŒï¼š</strong> å¾ˆå¤šè³‡æºéƒ½æ˜¯ä¸€æ¬¡æ€§å†ä¹Ÿä¸æœƒå­˜å–ç¬¬äºŒæ¬¡
<ul>
<li><strong>å‡èªªï¼š</strong> æ¸›å°‘ç¡¬ç¢Ÿå¯«å…¥å¯åŠ é€Ÿç¡¬ç¢Ÿè®€å–</li>
<li><strong>æ–¹æ³•ï¼š</strong> åª cache ç¬¬äºŒæ¬¡å­˜å–çš„è³‡æº</li>
<li><strong>çµæœï¼š</strong> æ¸›å°‘ç¡¬ç¢Ÿå¯«å…¥æ¬¡æ•¸ï¼ŒP75 cache hit duration ä¹Ÿé™ä½ï¼Œå› ç‚ºä¸éœ€è¦ evict éç†±é»è³‡æºã€cache hit ratio å’Œ retention ä¹Ÿæé«˜äº†</li>
</ul>
</li>
</ul>
<h3 id=å¦‚ä½•å¯¦ä½œ>å¦‚ä½•å¯¦ä½œ<a hidden class=anchor aria-hidden=true href=#å¦‚ä½•å¯¦ä½œ>#</a></h3>
<p><strong>è§£æ³•ä¸€ï¼š</strong> ç´€éŒ„å­˜å–æ¬¡æ•¸ï¼Œä½†ä¸è¦å¿«å–</p>
<ul>
<li>ç”¨ <a href=https://en.wikipedia.org/wiki/Bloom_filter>bloom filter</a> ç­‰ memory-efficient è³‡æ–™çµæ§‹ä¾†å„²å­˜å­˜å–æ¬¡æ•¸</li>
<li>æ–°å•é¡Œï¼šè³‡æºéƒ½æœƒ miss ç¬¬äºŒæ¬¡æ‰æœƒè¢« cacheï¼Œé€™å° CDN ä¾›æ‡‰å•†æˆ–å®¢æˆ¶ä¾†èªªéƒ½ç„¡æ³•æ¥å—ã€‚</li>
</ul>
<p><strong>è§£æ³•äºŒï¼š</strong> å¤šä¸€å€‹ transient cache (in memory cache)ã€‚</p>
<ul>
<li>å…ˆå°‡æ¬²å¿«å–åˆ° SSD çš„è³‡æºæ”¾åœ¨ memory ä¸­ï¼Œå¦‚æœå­˜å–å®ƒå¤ªå¤šæ¬¡ï¼Œå°± promote åˆ° SSD ä¸­</li>
<li>æ²’è¢« promote çš„è³‡æºæœ€å¾Œæœƒè¢« evict</li>
</ul>
<h2 id=æ¬Šè¡¡>æ¬Šè¡¡<a hidden class=anchor aria-hidden=true href=#æ¬Šè¡¡>#</a></h2>
<p>é€™è½èµ·ä¾†å¾ˆåˆç†ï¼Œå…¨éƒ¨æ”¾åˆ° memory ä¸­ï¼Œä½†å…¶å¯¦éœ€è¦åœ¨ SSD å£½å‘½ã€cache tail hit latency å’Œ memory ä½¿ç”¨é‡ä¹‹é–“æ¬Šè¡¡ï¼Œè€Œé€™æ¬¡å½±éŸ¿æœ€å¤§çš„å°±æ˜¯ memory ä½¿ç”¨é‡ä¸Šå‡ï¼š</p>
<ul>
<li><strong>transient cache memory ç©¶ç«Ÿè¦å¤šå¤§ï¼š</strong> å½±éŸ¿ evictionã€cache hit ratio</li>
<li><strong>å’Œ page cache ç«¶çˆ­ï¼š</strong> page cache æŠ“ç†±é–€è³‡æºã€ä½† transient cache å¤§å¤šç‚ºéç†±é–€ï¼Œæœ‰æ’æ“ æ•ˆæ‡‰</li>
<li><strong>å’Œ process memory ç«¶çˆ­ï¼š</strong> process å’Œ page cache ä¸ä¸€æ¨£ï¼Œå° memory æœ‰å‰›æ€§éœ€æ±‚ï¼Œè€Œä¸” edge service çš„å‡ç´šéœ€è¦ zero downtimeï¼Œæ‰€ä»¥æœƒåŒæ™‚æœ‰å…©å€‹ç‰ˆæœ¬çš„æœå‹™ï¼ˆ<a href=https://tech.hahow.in/%E6%B7%BA%E8%AB%87-hahow-%E8%97%8D%E7%B6%A0%E9%83%A8%E7%BD%B2-1c99d42336a9>è—ç¶ ä½ˆç½² ğŸ™ƒ</a>ï¼‰ï¼Œå¦‚æœè¨˜æ†¶é«”ä¸å¤ ï¼Œå°±æœƒè®“ page cache æ¸›å°‘ï¼Œåè€Œå¢åŠ  IOã€‚</li>
</ul>
<p>æœ‰æ®µè©±é€éœ²å‡º Cloudflare å°æ–¼å®¢æˆ¶å¤ªåœ¨ä¹ miss rate çš„æŠ±æ€¨ï¼Œèªç‚ºåªæ˜¯åœ¨åšå–ã€Œçœ¼çƒæ•ˆèƒ½ã€ğŸ˜ˆ</p>
<blockquote>
<p>From a customer&rsquo;s perspective, cache retention being too short is unacceptable because it leads to more misses, commensurate higher cost, and <strong><em>worse eyeball performance</em></strong>.</p>
</blockquote>
<h2 id=çµæœèˆ‡å±•æœ›>çµæœèˆ‡å±•æœ›<a hidden class=anchor aria-hidden=true href=#çµæœèˆ‡å±•æœ›>#</a></h2>
<p>Cloudlfare æ¡å–åœ¨æ–°çš„æ©Ÿå™¨ä¸Šéƒ¨ç½²æ–°çš„ transient cacheï¼Œä¸¦åªåœ¨éƒ¨åˆ† asset ä½¿ç”¨ï¼Œä¸æ–·å°‹æ‰¾ memory size çš„ç”œèœœé»ï¼Œæœ€å¾Œçµæœç‚º</p>
<ul>
<li>åœ¨ SSD å£½å‘½ã€cache tail hit latency å’Œ memory ä½¿ç”¨é‡ä¸‰è€…é–“ï¼ŒCloudflare é¸æ“‡å‰å…©è€…</li>
<li>æ¸›å°‘ 20%-25% SSD å¯«å…¥</li>
<li>CDN tail latency åœ¨é«˜å³°æœŸé–“ä¹Ÿæ¸›å°‘äº† 20%</li>
</ul>
<p>è€Œå°æœªä¾†å¯ä»¥åšæ›´å¥½çš„éƒ¨åˆ†å‰‡æ˜¯ï¼š</p>
<ul>
<li><strong>éƒ¨ç½²æ›´å¤šï¼š</strong> èˆŠæ©Ÿå™¨é€€å½¹å¾Œï¼Œæ–°ä¸–ä»£æ©Ÿå™¨ï¼ˆæ›´å¤š memory çš„æ©Ÿå™¨ï¼‰å°±æœƒä¸Šå»</li>
<li><strong>æ›´æ™ºæ…§çš„ promotion æ¼”ç®—æ³•ï¼š</strong> ç¾åœ¨åƒ…é€éè³‡æºè§¸æ“Šæ•¸ï¼Œæœªä¾†å¯ä¾æ“šè³‡æºçš„ TTL æ±ºå®šæ˜¯å¦ promoteï¼›å¦ä¸€é¢å‘å‰‡æ˜¯ demotionï¼Œé›–ç„¶ä¸æœƒæ¸›å°‘ç¡¬ç¢Ÿå¯«å…¥ï¼Œä½†å¯å¢åŠ  cache hit ratio å’Œ cache retention</li>
<li><strong>ç”¨å…¶ä»–å„²å­˜è£ç½®åš transient cacheï¼š</strong> é¸æ“‡ memory æ˜¯å› ç‚ºæè€—èŠ±è²»ä½ï¼ŒHDD åŒæ¨£è€æ“ï¼Œå¯ä»¥è€ƒæ…®æ··åˆ SSDã€HDDã€memory åœ¨è²»ç”¨å’Œæ•ˆèƒ½å–å¾—å¹³è¡¡</li>
</ul>
</div>
<footer class=post-footer>
<ul class=post-tags>
<li><a href=https://weihanglo.tw/tags/cache/>Cache</a></li>
<li><a href=https://weihanglo.tw/tags/databases/>Databases</a></li>
</ul>
<nav class=paginav>
<a class=prev href=https://weihanglo.tw/posts/2020/www-0x0f/>
<span class=title>Â« Prev Page</span>
<br>
<span>WWW 0x0F: å·¥ç¨‹å¸«å”¯ä¸€éœ€è¦çŸ¥é“çš„æ•¸å­—æ˜¯ä¼´ä¾¶ç”Ÿæ—¥</span>
</a>
<a class=next href=https://weihanglo.tw/posts/2020/www-0x0d/>
<span class=title>Next Page Â»</span>
<br>
<span>WWW 0x0D: å·²é”ä¸Šé™</span>
</a>
</nav>
</footer>
</article>
</main>
<footer class=footer>
<span>CC BY-NC-SA 4.0</span>
<span>
Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a>
</span>
</footer>
<a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a>
<script>let menu=document.getElementById('menu');menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script>
<script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script>
<script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script>
</body>
</html>