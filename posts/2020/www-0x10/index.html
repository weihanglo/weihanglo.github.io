<!doctype html><html lang=en dir=auto>
<head><meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<meta name=robots content="index, follow">
<title>WWW 0x10: 重構不是病，寫起來要人命 | Weihang Lo</title>
<meta name=keywords content="Rust,DevOps,Databases">
<meta name=description content="這裡是 WWW 第拾陸期，Wow Weihang Weekly 是一個毫無章法的個人週刊，出刊週期極不固定，從一週到五年都有可能。初期內容以軟體工程為主，等財富自由後會有更多雜">
<meta name=author content>
<link rel=canonical href=https://weihanglo.tw/posts/2020/www-0x10/>
<link crossorigin=anonymous href=/assets/css/stylesheet.min.css rel="preload stylesheet" as=style>
<script defer crossorigin=anonymous src=/assets/js/highlight.min.js onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://weihanglo.tw/favicon.ico>
<link rel=icon type=image/png sizes=16x16 href=https://weihanglo.tw/favicon-16x16.png>
<link rel=icon type=image/png sizes=32x32 href=https://weihanglo.tw/favicon-32x32.png>
<link rel=apple-touch-icon href=https://weihanglo.tw/apple-touch-icon.png>
<link rel=mask-icon href=https://weihanglo.tw/safari-pinned-tab.svg>
<meta name=theme-color content="#2e2e33">
<meta name=msapplication-TileColor content="#2e2e33">
<noscript>
<style>#theme-toggle,.top-link{display:none}</style>
<style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style>
</noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css integrity=sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ crossorigin=anonymous>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.js integrity=sha384-VQ8d8WVFw0yHhCk5E8I86oOhv48xLpnDZx5T9GogA/Y84DcCKWXDmSDfn13bzFZY crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/contrib/auto-render.min.js integrity=sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR crossorigin=anonymous></script>
<script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:'$$',right:'$$',display:!0},{left:'$',right:'$',display:!1},{left:'\\(',right:'\\)',display:!1},{left:'\\[',right:'\\]',display:!0}],throwOnError:!1})})</script>
<meta property="og:title" content="WWW 0x10: 重構不是病，寫起來要人命">
<meta property="og:description" content="這裡是 WWW 第拾陸期，Wow Weihang Weekly 是一個毫無章法的個人週刊，出刊週期極不固定，從一週到五年都有可能。初期內容以軟體工程為主，等財富自由後會有更多雜">
<meta property="og:type" content="article">
<meta property="og:url" content="https://weihanglo.tw/posts/2020/www-0x10/"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2020-05-09T00:00:00+08:00">
<meta property="article:modified_time" content="2020-05-09T00:00:00+08:00">
<meta name=twitter:card content="summary">
<meta name=twitter:title content="WWW 0x10: 重構不是病，寫起來要人命">
<meta name=twitter:description content="這裡是 WWW 第拾陸期，Wow Weihang Weekly 是一個毫無章法的個人週刊，出刊週期極不固定，從一週到五年都有可能。初期內容以軟體工程為主，等財富自由後會有更多雜">
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://weihanglo.tw/posts/"},{"@type":"ListItem","position":3,"name":"WWW 0x10: 重構不是病，寫起來要人命","item":"https://weihanglo.tw/posts/2020/www-0x10/"}]}</script>
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"WWW 0x10: 重構不是病，寫起來要人命","name":"WWW 0x10: 重構不是病，寫起來要人命","description":"這裡是 WWW 第拾陸期，Wow Weihang Weekly 是一個毫無章法的個人週刊，出刊週期極不固定，從一週到五年都有可能。初期內容以軟體工程為主，等財富自由後會有更多雜","keywords":["Rust","DevOps","Databases"],"articleBody":"這裡是 WWW 第拾陸期，Wow Weihang Weekly 是一個毫無章法的個人週刊，出刊週期極不固定，從一週到五年都有可能。初期內容以軟體工程為主，等財富自由後會有更多雜食篇章。\nGraceful shutdown in Kubernetes is not always trivial 對不起，分享一篇 medium 付費牆的文章。重點節錄：\n 讓你的 app delay 一些時間再停止接收 connection 如果你沒辦法控制 app（code 不是你寫的），可加 preStop hook 來控制 如果加了沒用，請去看該 app 如何處理各種 Signal 請測試，請分析，不要盲目寫完就當作自己做好 graceful shutdown  三篇文章了解 TiDB 技术内幕 - 说计算 由於開源資料庫系統 TiDB 為中國人研發，中文撰寫的文件非常多，這篇主要介紹 SQL 的 relation model 如何映射到 Key-Value model，處理 index 和 unique index 也不相同。很有趣，值得一讀（TiDB/TiKV 的 source code 也是 😂）。\nRewriting the heart of our sync engine Dropbox 重寫整個電腦版的同步引擎 Nucleus，花了四年時間，節錄些（其實不是節錄）有趣發現：\n🤯 同步檔案有下列幾個困難點  分散式系統：client 常常 offline、或是在不同的裝置同步，扎扎實實就是個分散式系統 耐用性：不同作業系統有不同的實作，有些時候甚至要 reverse-engineering，不過這通常會影響到很小部分人 測試檔案同步：各種連線狀況、本地讀取、寫檔到硬碟、不同的 snapshot、上傳、chunk transfer 同步行為：不同 client 任意移動資料夾，造成資料夾間 circular cycle  ✏️ 為什麼要重寫 雖然原始的同步服務很成功，團隊也不斷重構最佳化，但程式碼並不健康，最大幾個問題是：\n Consistency： data model 沒有考慮共享性，consistency guarantees 不強 Testability： 系統可測試性不夠強，反而依靠 slow rollout 然後開始 debugging Concurrency： 最後當然是 concurrent 問題，不好測，不好重現，只好用粗粒度的鎖，犧牲一些效能  📝 系統重寫核對清單 整篇文章只有這部分最有趣，因為 Dropbox 團隊知道重寫其實容易是不明智的決策，但團隊還是很清楚列出決定重寫的關鍵（說不定是事後諸葛）。\n 是否窮盡所有漸進改善方案  有試過重構現有模組嗎 有針對熱點分析改善嗎 可階段性發佈漸進改善的成果嗎   是否有足夠能力重寫專案  對現有專案完全瞭解到考古程度嗎 有足夠的工程資源嗎 可接受新功能開發步調趨緩嗎   是否知道專案的未來方向  重寫真的會改善嗎 新系統有制定各種原則嗎    我懶得詳述 Dropbox 對這些問題的答案，但它們其實透過 MyPy（印象中 MyPy 就是 Dropbox 發揚光大）還有各種 profiling 工具不斷重構，但仍然決定重寫。其中完全跳脫我的思維的是最後一點，重寫新系統其實就是「 重新塑造工程文化 」的好時機（也是大搞辦公室政治的好時機 😈），善用這個機會，團隊肯定煥然一新。\n Starting from scratch is a great opportunity to reset technical culture for a team.\n 📦 所以 Dropbox 到底做了什麼 寫了這麼多，應該已經猜到 Dropbox 做了什麼，對，就是用 Rust 重寫他們整個 Desktop client sync engine。Rust 對 Dropbox 來說是個「force multiplier」，使用 Rust 是最好的技術決策之一，除了效能，type system 和 AOT compiling checking 才是讓團隊笑到最後的關鍵因素。\n廣告快打完了，還是提一下新的 sync engine Nucleus 到底葫蘆裡賣什麼課程：\n Threading model 簡化： 幾乎所有 code 都在 single thread（a.k.a「The Control Thread」）用了 Rust 非同步的 de facto futures.rs，剩下 network IO 放到 event loop（未看先猜是 tokio），CPU-heavy task 有 thread pool，檔案系統 IO 也有個 dedicated thread。乾乾淨淨，清潔溜溜。 Deterministic 增加 testability： The Control Thread 在輸入值和排程法確定的條件下，行為是 deterministic，解決了舊系統不容易寫測試的問題，也能簡單重現錯誤，甚至可以用個做 pseudorandom 的 input、檔案、系統狀態和錯誤。 重新設計具有 strong consistency 的 client-server protocol： 共享的檔案和目錄終於有全域 ID，檔案和目錄的移動是 O(1)，和他們 subtree 的大小無關（不知道底層怎麼做到）。  然後 Dropbox 正在找會寫 Rust 的 infra team member，帥。\n 沒錯，Rust 早就滲透你我的生活，人遲早會鏽蝕\n ","wordCount":"1522","inLanguage":"en","datePublished":"2020-05-09T00:00:00+08:00","dateModified":"2020-05-09T00:00:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://weihanglo.tw/posts/2020/www-0x10/"},"publisher":{"@type":"Organization","name":"Weihang Lo","logo":{"@type":"ImageObject","url":"https://weihanglo.tw/favicon.ico"}}}</script>
</head>
<body id=top>
<script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add('dark'):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove('dark'):window.matchMedia('(prefers-color-scheme: dark)').matches&&document.body.classList.add('dark')</script>
<header class=header>
<nav class=nav>
<div class=logo>
<a href=https://weihanglo.tw accesskey=h title="Weihang Lo (Alt + H)">Weihang Lo</a>
<span class=logo-switches>
<button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
</button>
</span>
</div>
<ul id=menu>
<li>
<a href=https://weihanglo.tw/ title=Home>
<span>Home</span>
</a>
</li>
<li>
<a href=https://weihanglo.tw/posts/ title=Posts>
<span>Posts</span>
</a>
</li>
<li>
<a href=https://weihanglo.tw/tags/ title=Tags>
<span>Tags</span>
</a>
</li>
<li>
<a href=https://weihanglo.tw/about/ title=About>
<span>About</span>
</a>
</li>
</ul>
</nav>
</header>
<main class=main>
<article class=post-single>
<header class=post-header>
<h1 class=post-title>
WWW 0x10: 重構不是病，寫起來要人命
</h1>
<div class=post-meta><span title="2020-05-09 00:00:00 +0800 +0800">May 9, 2020</span>&nbsp;·&nbsp;4 min
</div>
</header> <div class=toc>
<details>
<summary accesskey=c title="(Alt + C)">
<span class=details>Table of Contents</span>
</summary>
<div class=inner><ul>
<li>
<a href=#graceful-shutdown-in-kubernetes-is-not-always-trivialhttpsmediumcomflant-comkubernetes-graceful-shutdown-nginx-php-fpm-d5ab266963c2 aria-label="Graceful shutdown in Kubernetes is not always trivial"><a href=https://medium.com/flant-com/kubernetes-graceful-shutdown-nginx-php-fpm-d5ab266963c2>Graceful shutdown in Kubernetes is not always trivial</a></a></li>
<li>
<a href=#%e4%b8%89%e7%af%87%e6%96%87%e7%ab%a0%e4%ba%86%e8%a7%a3-tidb-%e6%8a%80%e6%9c%af%e5%86%85%e5%b9%95---%e8%af%b4%e8%ae%a1%e7%ae%97httpspingcapcomblog-cntidb-internal-2 aria-label="三篇文章了解 TiDB 技术内幕 - 说计算"><a href=https://pingcap.com/blog-cn/tidb-internal-2/>三篇文章了解 TiDB 技术内幕 - 说计算</a></a></li>
<li>
<a href=#rewriting-the-heart-of-our-sync-enginehttpsdropboxtechinfrastructurerewriting-the-heart-of-our-sync-engine aria-label="Rewriting the heart of our sync engine"><a href=https://dropbox.tech/infrastructure/rewriting-the-heart-of-our-sync-engine>Rewriting the heart of our sync engine</a></a><ul>
<li>
<a href=#-%e5%90%8c%e6%ad%a5%e6%aa%94%e6%a1%88%e6%9c%89%e4%b8%8b%e5%88%97%e5%b9%be%e5%80%8b%e5%9b%b0%e9%9b%a3%e9%bb%9e aria-label="🤯 同步檔案有下列幾個困難點">🤯 同步檔案有下列幾個困難點</a></li>
<li>
<a href=#-%e7%82%ba%e4%bb%80%e9%ba%bc%e8%a6%81%e9%87%8d%e5%af%ab aria-label="✏️ 為什麼要重寫">✏️ 為什麼要重寫</a></li>
<li>
<a href=#-%e7%b3%bb%e7%b5%b1%e9%87%8d%e5%af%ab%e6%a0%b8%e5%b0%8d%e6%b8%85%e5%96%ae aria-label="📝 系統重寫核對清單">📝 系統重寫核對清單</a></li>
<li>
<a href=#-%e6%89%80%e4%bb%a5-dropbox-%e5%88%b0%e5%ba%95%e5%81%9a%e4%ba%86%e4%bb%80%e9%ba%bc aria-label="📦 所以 Dropbox 到底做了什麼">📦 所以 Dropbox 到底做了什麼</a>
</li>
</ul>
</li>
</ul>
</div>
</details>
</div>
<div class=post-content><p>這裡是 WWW 第拾陸期，Wow Weihang Weekly 是一個毫無章法的個人週刊，出刊週期極不固定，從一週到五年都有可能。初期內容以軟體工程為主，等財富自由後會有更多雜食篇章。</p>
<h2 id=graceful-shutdown-in-kubernetes-is-not-always-trivialhttpsmediumcomflant-comkubernetes-graceful-shutdown-nginx-php-fpm-d5ab266963c2><a href=https://medium.com/flant-com/kubernetes-graceful-shutdown-nginx-php-fpm-d5ab266963c2>Graceful shutdown in Kubernetes is not always trivial</a><a hidden class=anchor aria-hidden=true href=#graceful-shutdown-in-kubernetes-is-not-always-trivialhttpsmediumcomflant-comkubernetes-graceful-shutdown-nginx-php-fpm-d5ab266963c2>#</a></h2>
<p>對不起，分享一篇 medium 付費牆的文章。重點節錄：</p>
<ul>
<li>讓你的 app delay 一些時間再停止接收 connection</li>
<li>如果你沒辦法控制 app（code 不是你寫的），可加 <code>preStop</code> hook 來控制</li>
<li>如果加了沒用，請去看該 app 如何處理各種 Signal</li>
<li>請測試，請分析，不要盲目寫完就當作自己做好 graceful shutdown</li>
</ul>
<h2 id=三篇文章了解-tidb-技术内幕---说计算httpspingcapcomblog-cntidb-internal-2><a href=https://pingcap.com/blog-cn/tidb-internal-2/>三篇文章了解 TiDB 技术内幕 - 说计算</a><a hidden class=anchor aria-hidden=true href=#三篇文章了解-tidb-技术内幕---说计算httpspingcapcomblog-cntidb-internal-2>#</a></h2>
<p>由於開源資料庫系統 <a href=https://pingcap.com>TiDB</a> 為中國人研發，中文撰寫的文件非常多，這篇主要介紹 SQL 的 relation model 如何映射到 Key-Value model，處理 index 和 unique index 也不相同。很有趣，值得一讀（TiDB/TiKV 的 source code 也是 😂）。</p>
<h2 id=rewriting-the-heart-of-our-sync-enginehttpsdropboxtechinfrastructurerewriting-the-heart-of-our-sync-engine><a href=https://dropbox.tech/infrastructure/rewriting-the-heart-of-our-sync-engine>Rewriting the heart of our sync engine</a><a hidden class=anchor aria-hidden=true href=#rewriting-the-heart-of-our-sync-enginehttpsdropboxtechinfrastructurerewriting-the-heart-of-our-sync-engine>#</a></h2>
<p><img loading=lazy src=https://dropbox.tech/cms/content/dam/dropbox/tech-blog/en-us/2020/03/01.png alt>
</p>
<p>Dropbox 重寫整個電腦版的同步引擎 <strong>Nucleus</strong>，花了四年時間，節錄些（其實不是節錄）有趣發現：</p>
<h3 id=-同步檔案有下列幾個困難點>🤯 同步檔案有下列幾個困難點<a hidden class=anchor aria-hidden=true href=#-同步檔案有下列幾個困難點>#</a></h3>
<ul>
<li>分散式系統：client 常常 offline、或是在不同的裝置同步，扎扎實實就是個分散式系統</li>
<li>耐用性：不同作業系統有不同的實作，有些時候甚至要 reverse-engineering，不過這通常會影響到很小部分人</li>
<li>測試檔案同步：各種連線狀況、本地讀取、寫檔到硬碟、不同的 snapshot、上傳、chunk transfer</li>
<li>同步行為：不同 client 任意移動資料夾，造成資料夾間 circular cycle</li>
</ul>
<h3 id=-為什麼要重寫>✏️ 為什麼要重寫<a hidden class=anchor aria-hidden=true href=#-為什麼要重寫>#</a></h3>
<p>雖然原始的同步服務很成功，團隊也不斷重構最佳化，但程式碼並不健康，最大幾個問題是：</p>
<ul>
<li><strong>Consistency：</strong> data model 沒有考慮共享性，consistency guarantees 不強</li>
<li><strong>Testability：</strong> 系統可測試性不夠強，反而依靠 slow rollout 然後開始 debugging</li>
<li><strong>Concurrency：</strong> 最後當然是 concurrent 問題，不好測，不好重現，只好用粗粒度的鎖，犧牲一些效能</li>
</ul>
<h3 id=-系統重寫核對清單>📝 系統重寫核對清單<a hidden class=anchor aria-hidden=true href=#-系統重寫核對清單>#</a></h3>
<p>整篇文章<del>只有</del>這部分最有趣，因為 Dropbox 團隊知道<a href=https://www.joelonsoftware.com/2000/04/06/things-you-should-never-do-part-i/>重寫其實容易是不明智的決策</a>，但團隊還是很清楚列出決定重寫的關鍵（說不定是事後諸葛）。</p>
<ol>
<li>是否窮盡所有漸進改善方案
<ol>
<li>有試過重構現有模組嗎</li>
<li>有針對熱點分析改善嗎</li>
<li>可階段性發佈漸進改善的成果嗎</li>
</ol>
</li>
<li>是否有足夠能力重寫專案
<ol>
<li>對現有專案完全瞭解到考古程度嗎</li>
<li>有足夠的工程資源嗎</li>
<li>可接受新功能開發步調趨緩嗎</li>
</ol>
</li>
<li>是否知道專案的未來方向
<ol>
<li>重寫真的會改善嗎</li>
<li>新系統有制定各種原則嗎</li>
</ol>
</li>
</ol>
<p>我懶得詳述 Dropbox 對這些問題的答案，但它們其實透過 <a href=http://mypy-lang.org/>MyPy</a>（印象中 MyPy 就是 Dropbox 發揚光大）還有各種 profiling 工具不斷重構，但仍然決定重寫。其中完全跳脫我的思維的是最後一點，重寫新系統其實就是「 <strong>重新塑造工程文化</strong> 」的好時機（也是大搞辦公室政治的好時機 😈），善用這個機會，團隊肯定煥然一新。</p>
<blockquote>
<p>Starting from scratch is a great opportunity to reset technical culture for a team.</p>
</blockquote>
<h3 id=-所以-dropbox-到底做了什麼>📦 所以 Dropbox 到底做了什麼<a hidden class=anchor aria-hidden=true href=#-所以-dropbox-到底做了什麼>#</a></h3>
<p>寫了這麼多，應該已經猜到 Dropbox 做了什麼，對，就是用 <strong>Rust</strong> 重寫他們整個 Desktop client sync engine。Rust 對 Dropbox 來說是個「force multiplier」，使用 Rust 是最好的技術決策之一，除了效能，type system 和 AOT compiling checking 才是讓團隊笑到最後的關鍵因素。</p>
<p>廣告快打完了，還是提一下新的 sync engine <strong>Nucleus</strong> 到底葫蘆裡賣什麼課程：</p>
<ul>
<li><strong>Threading model 簡化：</strong> 幾乎所有 code 都在 single thread（a.k.a「The Control Thread」）用了 Rust 非同步的 de facto <a href=https://github.com/rust-lang/futures-rs>futures.rs</a>，剩下 network IO 放到 event loop（未看先猜是 <a href=https://tokio.rs>tokio</a>），CPU-heavy task 有 thread pool，檔案系統 IO 也有個 dedicated thread。乾乾淨淨，清潔溜溜。</li>
<li><strong>Deterministic 增加 testability：</strong> The Control Thread 在輸入值和排程法確定的條件下，行為是 deterministic，解決了舊系統不容易寫測試的問題，也能簡單重現錯誤，甚至可以用個做 pseudorandom 的 input、檔案、系統狀態和錯誤。</li>
<li><strong>重新設計具有 strong consistency 的 client-server protocol：</strong> 共享的檔案和目錄終於有全域 ID，檔案和目錄的移動是 O(1)，和他們 subtree 的大小無關（不知道底層怎麼做到）。</li>
</ul>
<p>然後 Dropbox 正在找會寫 Rust 的 infra team member，帥。</p>
<blockquote>
<p>沒錯，Rust 早就滲透你我的生活，人遲早會鏽蝕</p>
</blockquote>
</div>
<footer class=post-footer>
<ul class=post-tags>
<li><a href=https://weihanglo.tw/tags/rust/>Rust</a></li>
<li><a href=https://weihanglo.tw/tags/devops/>DevOps</a></li>
<li><a href=https://weihanglo.tw/tags/databases/>Databases</a></li>
</ul>
<nav class=paginav>
<a class=prev href=https://weihanglo.tw/posts/2020/www-0x11/>
<span class=title>« Prev Page</span>
<br>
<span>WWW 0x11: 庫存文章已用罄</span>
</a>
<a class=next href=https://weihanglo.tw/posts/2020/www-0x0f/>
<span class=title>Next Page »</span>
<br>
<span>WWW 0x0F: 工程師唯一需要知道的數字是伴侶生日</span>
</a>
</nav>
</footer>
</article>
</main>
<footer class=footer>
<span>CC BY-NC-SA 4.0</span>
<span>
Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a>
</span>
</footer>
<a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a>
<script>let menu=document.getElementById('menu');menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script>
<script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script>
<script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script>
</body>
</html>