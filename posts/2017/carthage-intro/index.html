<!doctype html><html lang=en dir=auto>
<head><meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<meta name=robots content="index, follow">
<title>Carthage 套件管理工具 | Life is a refactoring process without tests</title>
<meta name=keywords content="Carthage,Swift">
<meta name=description content="Carthage 是一個較新的 Cocoa 開發第三方套件管理工具，相較於知名 CocoaPods 管理工具的複雜配置，輕巧的 Carthage 在推出之後廣受 Swift 社群喜愛。 （撰於 2017-03-05，基於 Carthage">
<meta name=author content>
<link rel=canonical href=https://weihanglo.tw/posts/2017/carthage-intro/>
<link crossorigin=anonymous href=/assets/css/stylesheet.css rel="preload stylesheet" as=style>
<link rel=icon href=https://weihanglo.tw/favicon.ico>
<link rel=icon type=image/png sizes=16x16 href=https://weihanglo.tw/favicon-16x16.png>
<link rel=icon type=image/png sizes=32x32 href=https://weihanglo.tw/favicon-32x32.png>
<link rel=apple-touch-icon href=https://weihanglo.tw/apple-touch-icon.png>
<link rel=mask-icon href=https://weihanglo.tw/safari-pinned-tab.svg>
<meta name=theme-color content="#2e2e33">
<meta name=msapplication-TileColor content="#2e2e33">
<noscript>
<style>#theme-toggle,.top-link{display:none}</style>
<style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style>
</noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css integrity=sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ crossorigin=anonymous>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.js integrity=sha384-VQ8d8WVFw0yHhCk5E8I86oOhv48xLpnDZx5T9GogA/Y84DcCKWXDmSDfn13bzFZY crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/contrib/auto-render.min.js integrity=sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR crossorigin=anonymous></script>
<script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:'$$',right:'$$',display:!0},{left:'$',right:'$',display:!1},{left:'\\(',right:'\\)',display:!1},{left:'\\[',right:'\\]',display:!0}],throwOnError:!1})})</script>
<meta property="og:title" content="Carthage 套件管理工具">
<meta property="og:description" content="Carthage 是一個較新的 Cocoa 開發第三方套件管理工具，相較於知名 CocoaPods 管理工具的複雜配置，輕巧的 Carthage 在推出之後廣受 Swift 社群喜愛。 （撰於 2017-03-05，基於 Carthage">
<meta property="og:type" content="article">
<meta property="og:url" content="https://weihanglo.tw/posts/2017/carthage-intro/"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2017-03-05T08:45:57+08:00">
<meta property="article:modified_time" content="2017-03-05T08:45:57+08:00">
<meta name=twitter:card content="summary">
<meta name=twitter:title content="Carthage 套件管理工具">
<meta name=twitter:description content="Carthage 是一個較新的 Cocoa 開發第三方套件管理工具，相較於知名 CocoaPods 管理工具的複雜配置，輕巧的 Carthage 在推出之後廣受 Swift 社群喜愛。 （撰於 2017-03-05，基於 Carthage">
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://weihanglo.tw/posts/"},{"@type":"ListItem","position":3,"name":"Carthage 套件管理工具","item":"https://weihanglo.tw/posts/2017/carthage-intro/"}]}</script>
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Carthage 套件管理工具","name":"Carthage 套件管理工具","description":"Carthage 是一個較新的 Cocoa 開發第三方套件管理工具，相較於知名 CocoaPods 管理工具的複雜配置，輕巧的 Carthage 在推出之後廣受 Swift 社群喜愛。 （撰於 2017-03-05，基於 Carthage","keywords":["Carthage","Swift"],"articleBody":"Carthage 是一個較新的 Cocoa 開發第三方套件管理工具，相較於知名 CocoaPods 管理工具的複雜配置，輕巧的 Carthage 在推出之後廣受 Swift 社群喜愛。\n（撰於 2017-03-05，基於 Carthage 0.20: Unary, Binary, Ternary）\n特色  時代潮流：Written in Swift! (v.s. CocoaPods in Ruby) 主流現代：iOS 8+, dynamic framework only 去中心化：無提供類似 cocoapods、npm 這種中心儲存庫。 非入侵式：不會修改 Xcode 相關配置，耦合性低。  快速上手 從終端環境安裝 Carthage  brew install carthage  如果還沒有裝 homebrew，請來這下載\n  建立一個 Carfile，列出欲使用的模組，例如：  github \"Alamofire/Alamofire\" ~ 4.4 github \"ReactiveX/RxSwift\" ~ 3.0 在終端環境輸入 carthage update，Carthage 將自動下載所有相依模組至 Carthage/Checkouts 資料夾中，並編譯成 frameworks（或直接下載 pre-compiled framework）。 將 Carthage/Build 資料夾內編譯好的 frameworks 拖拉進你的 app target = General = Linked Frameworks and Libraries 在 app target = Build Phases 下新增一個 New Run Script Phase  # 自動將 framework 複製到 target app 的 bundle中 /usr/local/bin/carthage copy-frameworks 並在 Input Files 加入相依的 frameworks 路徑，例如：\n$(SRCROOT)/Carthage/Build/iOS/Alamofire.framework $(SRCROOT)/Carthage/Build/iOS/RxSwift.framework Cartfile 版號語法簡介 Cartfile 版號語法與 Podfile 雷同：\n# 版號 = 3.1.2 github \"ReactiveX/RxSwift\" = 3.1.2 # 版號 3.x (3.0 github \"SnapKit/SnapKit\" ~ 3.0 # 僅匹配版號 0.4.1 github \"jspahrsummers/libextobjc\" == 0.4.1 # 最新版 github \"jspahrsummers/xcconfigs\" # 指定 Git branch github \"jspahrsummers/xcconfigs\" \"branch\" # 其他 Git Server Repository 的 develop 分支 git \"https://agitserver.com/swift-test/swift-test.git\" \"develop\" # 本地 local Git Repository git \"file:///directory/to/project\" \"branch\" 常見議題 Q：Carthage 資料夾裡面究竟有啥？ Carthage/ ├── Build/ │ ├── iOS/ │ │ ├── Alamofire.framework │ │ ├── Alamofire.framework.dSYM │ │ ├── SnapKit.framework │ │ └── SnapKit.framework.dSYM │ └── macOS/ │ └── ... macOS 等其他平台 的 framework └── Checkouts/ ├── Alamofire/ │ ├── ... Alamofire clone 下來的原始碼 └── SnapKit/ └── ... SnapKit clone 下來的原始碼  Carthage/Build: 打包好的 framework（pre-built 或是從 checkouts build 出來的） Carthage/Checkouts: 所有相依模組的 source code  Q：如何避免 carthage udpate 取得的模組版號不同？ Carthage 提供一個鎖定文件 Cartfile.resolved，記錄了當前被確切安裝的模組精確版號。每次更動新增相依模組時，Cartfile.resolved 即會自動更新。可預防部分模組版號沒有完全遵循 語意化版本（SEMVER） 時產生的問題。\n建議將 Cartfile.resolved 提交至版本管理系統中。之後將遠端儲存庫 clone 下來，只需要執行\ncarthage bootstrap 就可以取得與提交時版號完全相同的模組了。\nQ：我不想提交 Carthage 資料夾到 Git Server，怎辦？ 一般而言，我們會將 Carthage 加入 Project 的 .gitignore 中：\n# in .gitignore Carthage 除非另有需求，不然 Cartfile.resolve 應足以還原 project 與提交時相同版號的模組環境。\nQ：我需要開發用但非 Project 相關的模組，該如何？ Carthage 提供另一個 Cartfile.private，配置方法與 Cartfile 相同。Cartfile.private 內的相依模組不會被作為主模組的 dependency。可用來配置開發用模組，譬如使用 testing framework。\nQ：如何只提供 binary framework，不開放 source code？ Carthage 提供的來源除了 Git 以外，事實上最近才提供 binary 這個選項。\nCartfile 範例如下：\nbinary \"https://example.com/release/ExampleFramework.json\" ~ 1.4.0 這裡的 json 檔應描述該 framework 對應版號的下載路徑，配置範例如下：\n{ \"1.3.5\": \"https://example.com/release/1.3.5/framework.zip\", \"1.4.3\": \"https://example.com/release/1.4.3/framework.tar.gz\" } 除此之外，目前只接受 https url 連結，且 version 只能對應語意化版本， Git branch／tag／commit 都暫時無法使用。\nQ：如何同時修改相依模組的 code，並在 Run 時同步更新嗎？ 可以，請新增一個 Run Script build phase，在 Run App 後會自動 build 新的 framework：\n/usr/local/bin/carthage build --platform \"$PLATFORM_NAME\" --project-directory \"$SRCROOT\" ！！！！！注意！！！！！\n所有在 Carthage/checkouts 內的 source 隨時可能改變。如果確定需要改動相依模組，請利用 carthage 指令將相依模組加入 Git submodules。\ncarthage update --use-submodules # or carthage checkout --use-submodules 之後就可以直接操作 Git submodules 了！\n","wordCount":"1312","inLanguage":"en","datePublished":"2017-03-05T08:45:57+08:00","dateModified":"2017-03-05T08:45:57+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://weihanglo.tw/posts/2017/carthage-intro/"},"publisher":{"@type":"Organization","name":"Life is a refactoring process without tests","logo":{"@type":"ImageObject","url":"https://weihanglo.tw/favicon.ico"}}}</script>
</head>
<body id=top>
<script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add('dark'):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove('dark'):window.matchMedia('(prefers-color-scheme: dark)').matches&&document.body.classList.add('dark')</script>
<header class=header>
<nav class=nav>
<div class=logo>
<a href=https://weihanglo.tw accesskey=h title="Life is a refactoring process without tests (Alt + H)">Life is a refactoring process without tests</a>
<div class=logo-switches>
<button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
</button>
</div>
</div>
<ul id=menu>
<li>
<a href=https://weihanglo.tw/ title=Home>
<span>Home</span>
</a>
</li>
<li>
<a href=https://weihanglo.tw/archives/ title=Archives>
<span>Archives</span>
</a>
</li>
<li>
<a href=https://weihanglo.tw/tags/ title=Tags>
<span>Tags</span>
</a>
</li>
<li>
<a href=https://weihanglo.tw/about/ title=About>
<span>About</span>
</a>
</li>
</ul>
</nav>
</header>
<main class=main>
<article class=post-single>
<header class=post-header>
<h1 class=post-title>
Carthage 套件管理工具
</h1>
<div class=post-meta><span title="2017-03-05 08:45:57 +0800 +0800">March 5, 2017</span>&nbsp;·&nbsp;3 min
</div>
</header> <div class=toc>
<details>
<summary accesskey=c title="(Alt + C)">
<span class=details>Table of Contents</span>
</summary>
<div class=inner><ul>
<li>
<a href=#%e7%89%b9%e8%89%b2 aria-label=特色>特色</a></li>
<li>
<a href=#%e5%bf%ab%e9%80%9f%e4%b8%8a%e6%89%8b aria-label=快速上手>快速上手</a></li>
<li>
<a href=#cartfile-%e7%89%88%e8%99%9f%e8%aa%9e%e6%b3%95%e7%b0%a1%e4%bb%8b aria-label="Cartfile 版號語法簡介">Cartfile 版號語法簡介</a></li>
<li>
<a href=#%e5%b8%b8%e8%a6%8b%e8%ad%b0%e9%a1%8c aria-label=常見議題>常見議題</a><ul>
<li>
<a href=#qcarthage-%e8%b3%87%e6%96%99%e5%a4%be%e8%a3%a1%e9%9d%a2%e7%a9%b6%e7%ab%9f%e6%9c%89%e5%95%a5 aria-label="Q：Carthage 資料夾裡面究竟有啥？">Q：Carthage 資料夾裡面究竟有啥？</a></li>
<li>
<a href=#q%e5%a6%82%e4%bd%95%e9%81%bf%e5%85%8d-carthage-udpate-%e5%8f%96%e5%be%97%e7%9a%84%e6%a8%a1%e7%b5%84%e7%89%88%e8%99%9f%e4%b8%8d%e5%90%8c aria-label="Q：如何避免 carthage udpate 取得的模組版號不同？">Q：如何避免 <code>carthage udpate</code> 取得的模組版號不同？</a></li>
<li>
<a href=#q%e6%88%91%e4%b8%8d%e6%83%b3%e6%8f%90%e4%ba%a4-carthage-%e8%b3%87%e6%96%99%e5%a4%be%e5%88%b0-git-server%e6%80%8e%e8%be%a6 aria-label="Q：我不想提交 Carthage 資料夾到 Git Server，怎辦？">Q：我不想提交 Carthage 資料夾到 Git Server，怎辦？</a></li>
<li>
<a href=#q%e6%88%91%e9%9c%80%e8%a6%81%e9%96%8b%e7%99%bc%e7%94%a8%e4%bd%86%e9%9d%9e-project-%e7%9b%b8%e9%97%9c%e7%9a%84%e6%a8%a1%e7%b5%84%e8%a9%b2%e5%a6%82%e4%bd%95 aria-label="Q：我需要開發用但非 Project 相關的模組，該如何？">Q：我需要開發用但非 Project 相關的模組，該如何？</a></li>
<li>
<a href=#q%e5%a6%82%e4%bd%95%e5%8f%aa%e6%8f%90%e4%be%9b-binary-framework%e4%b8%8d%e9%96%8b%e6%94%be-source-code aria-label="Q：如何只提供 binary framework，不開放 source code？">Q：如何只提供 binary framework，不開放 source code？</a></li>
<li>
<a href=#q%e5%a6%82%e4%bd%95%e5%90%8c%e6%99%82%e4%bf%ae%e6%94%b9%e7%9b%b8%e4%be%9d%e6%a8%a1%e7%b5%84%e7%9a%84-code%e4%b8%a6%e5%9c%a8-run-%e6%99%82%e5%90%8c%e6%ad%a5%e6%9b%b4%e6%96%b0%e5%97%8e aria-label="Q：如何同時修改相依模組的 code，並在 Run 時同步更新嗎？">Q：如何同時修改相依模組的 code，並在 Run 時同步更新嗎？</a>
</li>
</ul>
</li>
</ul>
</div>
</details>
</div>
<div class=post-content><p><a href=https://github.com/Carthage/Carthage>Carthage</a> 是一個較新的 Cocoa 開發第三方套件管理工具，相較於知名 <a href=https://cocoapods.org/>CocoaPods</a> 管理工具的複雜配置，輕巧的 Carthage 在推出之後廣受 Swift 社群喜愛。</p>
<p><em>（撰於 2017-03-05，基於 Carthage 0.20: Unary, Binary, Ternary）</em></p>
<h2 id=特色>特色<a hidden class=anchor aria-hidden=true href=#特色>#</a></h2>
<ul>
<li>時代潮流：Written in Swift! (v.s. CocoaPods in <em>Ruby</em>)</li>
<li>主流現代：iOS 8+, dynamic framework only</li>
<li>去中心化：無提供類似 cocoapods、npm 這種中心儲存庫。</li>
<li>非入侵式：不會修改 Xcode 相關配置，耦合性低。</li>
</ul>
<h2 id=快速上手>快速上手<a hidden class=anchor aria-hidden=true href=#快速上手>#</a></h2>
<ol start=0>
<li>從終端環境安裝 Carthage</li>
</ol>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>brew install carthage
</code></pre></div><blockquote>
<p>如果還沒有裝 homebrew，<a href=https://brew.sh/>請來這下載</a></p>
</blockquote>
<ol>
<li>建立一個 <code>Carfile</code>，列出欲使用的模組，例如：</li>
</ol>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby>github <span style=color:#e6db74>&#34;Alamofire/Alamofire&#34;</span> <span style=color:#f92672>~&gt;</span> <span style=color:#ae81ff>4</span><span style=color:#f92672>.</span><span style=color:#ae81ff>4</span>
github <span style=color:#e6db74>&#34;ReactiveX/RxSwift&#34;</span> <span style=color:#f92672>~&gt;</span> <span style=color:#ae81ff>3</span><span style=color:#f92672>.</span><span style=color:#ae81ff>0</span>
</code></pre></div><ol start=2>
<li>在終端環境輸入 <code>carthage update</code>，Carthage 將自動下載所有相依模組至 <code>Carthage/Checkouts</code> 資料夾中，並編譯成 frameworks（或直接下載 pre-compiled framework）。</li>
<li>將 <code>Carthage/Build</code> 資料夾內編譯好的 frameworks 拖拉進你的 <strong>app target</strong> => <strong>General</strong> => <strong>Linked Frameworks and Libraries</strong></li>
<li>在 <strong>app target</strong> => <strong>Build Phases</strong> 下新增一個 <strong>New Run Script Phase</strong></li>
</ol>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#75715e># 自動將 framework 複製到 target app 的 bundle中</span>
/usr/local/bin/carthage copy-frameworks
</code></pre></div><p>並在 <strong>Input Files</strong> 加入相依的 frameworks 路徑，例如：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#66d9ef>$(</span>SRCROOT<span style=color:#66d9ef>)</span>/Carthage/Build/iOS/Alamofire.framework
<span style=color:#66d9ef>$(</span>SRCROOT<span style=color:#66d9ef>)</span>/Carthage/Build/iOS/RxSwift.framework
</code></pre></div><h2 id=cartfile-版號語法簡介>Cartfile 版號語法簡介<a hidden class=anchor aria-hidden=true href=#cartfile-版號語法簡介>#</a></h2>
<p>Cartfile 版號語法與 Podfile 雷同：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby><span style=color:#75715e># 版號 &gt;= 3.1.2</span>
github <span style=color:#e6db74>&#34;ReactiveX/RxSwift&#34;</span> <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>3</span><span style=color:#f92672>.</span><span style=color:#ae81ff>1</span><span style=color:#f92672>.</span><span style=color:#ae81ff>2</span>

<span style=color:#75715e># 版號 3.x (3.0 &lt;= ver &lt; 4.0)</span>
github <span style=color:#e6db74>&#34;SnapKit/SnapKit&#34;</span> <span style=color:#f92672>~&gt;</span> <span style=color:#ae81ff>3</span><span style=color:#f92672>.</span><span style=color:#ae81ff>0</span>

<span style=color:#75715e># 僅匹配版號 0.4.1</span>
github <span style=color:#e6db74>&#34;jspahrsummers/libextobjc&#34;</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span><span style=color:#f92672>.</span><span style=color:#ae81ff>4</span><span style=color:#f92672>.</span><span style=color:#ae81ff>1</span>

<span style=color:#75715e># 最新版</span>
github <span style=color:#e6db74>&#34;jspahrsummers/xcconfigs&#34;</span>

<span style=color:#75715e># 指定 Git branch</span>
github <span style=color:#e6db74>&#34;jspahrsummers/xcconfigs&#34;</span> <span style=color:#e6db74>&#34;branch&#34;</span>

<span style=color:#75715e># 其他 Git Server Repository 的 develop 分支</span>
git <span style=color:#e6db74>&#34;https://agitserver.com/swift-test/swift-test.git&#34;</span> <span style=color:#e6db74>&#34;develop&#34;</span>

<span style=color:#75715e># 本地 local Git Repository</span>
git <span style=color:#e6db74>&#34;file:///directory/to/project&#34;</span> <span style=color:#e6db74>&#34;branch&#34;</span>
</code></pre></div><h2 id=常見議題>常見議題<a hidden class=anchor aria-hidden=true href=#常見議題>#</a></h2>
<h3 id=qcarthage-資料夾裡面究竟有啥>Q：Carthage 資料夾裡面究竟有啥？<a hidden class=anchor aria-hidden=true href=#qcarthage-資料夾裡面究竟有啥>#</a></h3>
<pre tabindex=0><code>Carthage/
├── Build/
│   ├── iOS/
│   │   ├── Alamofire.framework
│   │   ├── Alamofire.framework.dSYM
│   │   ├── SnapKit.framework
│   │   └── SnapKit.framework.dSYM
│   └── macOS/
│       └── ... macOS 等其他平台 的 framework
└── Checkouts/
    ├── Alamofire/
    │   ├── ... Alamofire clone 下來的原始碼
    └── SnapKit/
        └── ... SnapKit clone 下來的原始碼
</code></pre><ul>
<li>Carthage/Build: 打包好的 framework（pre-built 或是從 checkouts build 出來的）</li>
<li>Carthage/Checkouts: 所有相依模組的 source code</li>
</ul>
<h3 id=q如何避免-carthage-udpate-取得的模組版號不同>Q：如何避免 <code>carthage udpate</code> 取得的模組版號不同？<a hidden class=anchor aria-hidden=true href=#q如何避免-carthage-udpate-取得的模組版號不同>#</a></h3>
<p>Carthage 提供一個鎖定文件 <code>Cartfile.resolved</code>，記錄了當前被確切安裝的模組精確版號。每次更動新增相依模組時，<code>Cartfile.resolved</code> 即會自動更新。可預防部分模組版號沒有完全遵循 <a href=https://semver.org/lang/zh-TW/>語意化版本（SEMVER）</a> 時產生的問題。</p>
<p>建議將 <code>Cartfile.resolved</code> 提交至版本管理系統中。之後將遠端儲存庫 clone 下來，只需要執行</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>carthage bootstrap
</code></pre></div><p>就可以取得與提交時版號完全相同的模組了。</p>
<h3 id=q我不想提交-carthage-資料夾到-git-server怎辦>Q：我不想提交 Carthage 資料夾到 Git Server，怎辦？<a hidden class=anchor aria-hidden=true href=#q我不想提交-carthage-資料夾到-git-server怎辦>#</a></h3>
<p>一般而言，我們會將 Carthage 加入 Project 的 <code>.gitignore</code> 中：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#75715e># in .gitignore</span>
Carthage
</code></pre></div><p>除非另有需求，不然 <code>Cartfile.resolve</code> 應足以還原 project 與提交時相同版號的模組環境。</p>
<h3 id=q我需要開發用但非-project-相關的模組該如何>Q：我需要開發用但非 Project 相關的模組，該如何？<a hidden class=anchor aria-hidden=true href=#q我需要開發用但非-project-相關的模組該如何>#</a></h3>
<p>Carthage 提供另一個 <code>Cartfile.private</code>，配置方法與 <code>Cartfile</code> 相同。<code>Cartfile.private</code> 內的相依模組不會被作為主模組的 dependency。可用來配置開發用模組，譬如使用 testing framework。</p>
<h3 id=q如何只提供-binary-framework不開放-source-code>Q：如何只提供 binary framework，不開放 source code？<a hidden class=anchor aria-hidden=true href=#q如何只提供-binary-framework不開放-source-code>#</a></h3>
<p>Carthage 提供的來源除了 Git 以外，事實上<a href=https://github.com/Carthage/Carthage/commit/3a151a413350b980c68b2f1be8ca234e7947d575>最近才提供 binary</a> 這個選項。</p>
<p><strong>Cartfile</strong> 範例如下：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby>binary <span style=color:#e6db74>&#34;https://example.com/release/ExampleFramework.json&#34;</span> <span style=color:#f92672>~&gt;</span> <span style=color:#ae81ff>1</span><span style=color:#f92672>.</span><span style=color:#ae81ff>4</span><span style=color:#f92672>.</span><span style=color:#ae81ff>0</span>
</code></pre></div><p>這裡的 json 檔應描述該 framework 對應版號的下載路徑，配置範例如下：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json>{
    <span style=color:#f92672>&#34;1.3.5&#34;</span>: <span style=color:#e6db74>&#34;https://example.com/release/1.3.5/framework.zip&#34;</span>,
    <span style=color:#f92672>&#34;1.4.3&#34;</span>: <span style=color:#e6db74>&#34;https://example.com/release/1.4.3/framework.tar.gz&#34;</span>
}
</code></pre></div><p>除此之外，目前只接受 <code>https</code> url 連結，且 version 只能對應<a href=https://semver.org/lang/zh-TW/>語意化版本</a>， Git branch／tag／commit 都暫時無法使用。</p>
<h3 id=q如何同時修改相依模組的-code並在-run-時同步更新嗎>Q：如何同時修改相依模組的 code，並在 Run 時同步更新嗎？<a hidden class=anchor aria-hidden=true href=#q如何同時修改相依模組的-code並在-run-時同步更新嗎>#</a></h3>
<p>可以，請新增一個 <strong>Run Script</strong> build phase，在 Run App 後會自動 build 新的 framework：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>/usr/local/bin/carthage build --platform <span style=color:#e6db74>&#34;</span>$PLATFORM_NAME<span style=color:#e6db74>&#34;</span> --project-directory <span style=color:#e6db74>&#34;</span>$SRCROOT<span style=color:#e6db74>&#34;</span>
</code></pre></div><p><strong>！！！！！注意！！！！！</strong></p>
<p>所有在 Carthage/checkouts 內的 source 隨時可能改變。如果確定需要改動相依模組，請利用 <a href=https://github.com/Carthage/Carthage#using-submodules-for-dependencies>carthage 指令將相依模組加入 Git submodules</a>。</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>carthage update --use-submodules
<span style=color:#75715e># or</span>
carthage checkout --use-submodules
</code></pre></div><p>之後就可以直接操作 Git submodules 了！</p>
</div>
<footer class=post-footer>
<ul class=post-tags>
<li><a href=https://weihanglo.tw/tags/carthage/>Carthage</a></li>
<li><a href=https://weihanglo.tw/tags/swift/>Swift</a></li>
</ul>
<nav class=paginav>
<a class=prev href=https://weihanglo.tw/posts/2017/fed-toolchain/>
<span class=title>« Prev</span>
<br>
<span>大前端時代的工具箱</span>
</a>
<a class=next href=https://weihanglo.tw/posts/2017/swift-quick-note/>
<span class=title>Next »</span>
<br>
<span>Swift 初學速記</span>
</a>
</nav>
</footer>
</article>
</main>
<footer class=footer>
<span>CC BY-NC-SA 4.0</span>
<span>
Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a>
</span>
</footer>
<a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a>
<script>let menu=document.getElementById('menu');menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script>
<script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script>
<script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script>
</body>
</html>